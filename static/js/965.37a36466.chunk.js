"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[965],{8011:function(n,t,e){function i(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",e=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new URLSearchParams(window.location.search).get(n);return e?parseInt(i)||t:i||t}e.d(t,{Z:function(){return i}})},546:function(n,t){var e={validCoordinates:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n>=-50&&n<=50&&t>=-50&&t<=50},safeCoordinate:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Math.floor(n<-50?-50:n>50?50:n)},safeId:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Math.floor(n<1?1:n>10201?10201:n)},getId:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.safeId(101*(n+50)+(t+50+1))},getCoordinates:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.safeId(n)-1,e=Math.floor(t/101),i=Math.floor(t-101*e);return{x:e-50,y:i-50}}};t.Z=e},5617:function(n,t){var e=[4,5,5,4,3,3,4,3,1],i=[4,4,3,5,5,4,3,3,1],r=[4,3,4,3,4,5,5,3,1],a=[6,6,6,6,6,6,6,9,15];t.Z=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return[e[n],i[n],r[n],a[n]]}},3965:function(n,t,e){e.r(t),e.d(t,{default:function(){return U}});var i=e(5671),r=e(3144),a=e(136),o=e(8557),s=e(569),u=e(5003),l=e(3504),c=e(341),h=e(3360),d=e(2791),v=e(5617),f=e(546),p=e(8011),g=e(3896),x=e(860),y=e.n(x),j=(0,r.Z)((function n(t){(0,i.Z)(this,n),this.info=t.info,this.data=t.data}));function m(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return g.Z.request(y().MAP_VIEW_NORMAL,{id:Math.floor(n>=1&&n<=10201?n:0)})}g.Z.defineStructure(y().MAP_VIEW_NORMAL,j);var k=e(6371),Z=e(184),w={Position:[[16,104],[52,84],[88,64],[124,44],[160,24],[196,4],[232,-16],[53,124],[89,104],[125,84],[161,64],[197,44],[233,24],[269,4],[90,144],[126,124],[162,104],[198,84],[234,64],[270,44],[306,24],[127,164],[163,144],[199,124],[235,104],[271,84],[307,64],[343,44],[164,184],[200,164],[236,144],[272,124],[308,104],[344,84],[380,64],[201,204],[237,184],[273,164],[309,144],[345,124],[381,104],[417,84],[238,224],[274,204],[310,184],[346,164],[382,144],[418,124],[454,104]],Ruler:[[280,292],[280,8],[316,272],[316,28],[352,252],[352,48],[388,232],[388,68],[424,212],[424,88],[460,192],[460,108],[496,172],[496,128]],Arrows:["144,56 98,84 98,49","102,233 149,260 101,266","439,87 390,57 438,52","443,266 394,257 442,232"],Polygon:["53,137 90,157 53,177 16,157","89,117 126,137 89,157 52,137","125,97 162,117 125,137 88,117","161,77 198,97 161,117 124,97","197,57 234,77 197,97 160,77","233,37 270,57 233,77 196,57","269,17 306,37 269,57 232,37","90,157 127,177 90,197 53,177","126,137 163,157 126,177 89,157","162,117 199,137 162,157 125,137","198,97 235,117 198,137 161,117","234,77 271,97 234,117 197,97","270,57 307,77 270,97 233,77","306,37 343,57 306,77 269,57","127,177 164,197 127,217 90,197","163,157 200,177 163,197 126,177","199,137 236,157 199,177 162,157","235,117 272,137 235,157 198,137","271,97 308,117 271,137 234,117","307,77 344,97 307,117 270,97","343,57 380,77 343,97 306,77","164,197 201,217 164,237 127,217","200,177 237,197 200,217 163,197","236,157 273,177 236,197 199,177","272,137 309,157 272,177 235,157","308,117 345,137 308,157 271,137","344,97 381,117 344,137 307,117","380,77 417,97 380,117 343,97","201,217 238,237 201,257 164,237","237,197 274,217 237,237 200,217","273,177 310,197 273,217 236,197","309,157 346,177 309,197 272,177","345,137 382,157 345,177 308,157","381,117 418,137 381,157 344,137","417,97 454,117 417,137 380,117","238,237 275,257 238,277 201,257","274,217 311,237 274,257 237,237","310,197 347,217 310,237 273,217","346,177 383,197 346,217 309,197","382,157 419,177 382,197 345,177","418,137 455,157 418,177 381,157","454,117 491,137 454,157 417,137","275,257 312,277 275,297 238,277","311,237 348,257 311,277 274,257","347,217 384,237 347,257 310,237","383,197 420,217 383,237 346,217","419,177 456,197 419,217 382,197","455,157 492,177 455,197 418,177","491,137 528,157 491,177 454,157"]},C={id:0,x:0,y:0,isRequesting:!1,update:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=f.Z.safeId(n),e=f.Z.getCoordinates(t);return this.id=t,this.x=e.x,this.y=e.y,t}},N=function(n,t){return c.Z.safe(n,(function(n){return n.updateProps(t)}))},R=function(n,t,e){return c.Z.safe(n,(function(n){return n[t](e)}))},M=function(n){return R("map-view","request",C.update(n))},I=function(n){(0,a.Z)(e,n);var t=(0,o.Z)(e);function e(){return(0,i.Z)(this,e),t.apply(this,arguments)}return(0,r.Z)(e,[{key:"coordinate",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return n<-50?n+101:n>50?n-101:n}},{key:"navigate",value:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(i){i.preventDefault(),C.isRequesting||(C.isRequesting=!0,M(e?f.Z.getId(n.coordinate(C.x+t),C.y):f.Z.getId(C.x,n.coordinate(C.y+t))))}}},{key:"onRemoved",value:function(){C.id=0}},{key:"render",value:function(){return C.id=C.update((0,p.Z)("id",k.Z.activeVillageId,!0)),R("coordinates","updateInputs"),(0,Z.jsxs)("div",{id:"Map",children:[(0,Z.jsx)(q,{register:"map-info"}),(0,Z.jsxs)("svg",{className:"background",viewBox:"0 0 540 316",children:[(0,Z.jsx)("image",{xlinkHref:u.Z.map.background,width:540,height:316}),(0,Z.jsx)(A,{register:"map-view"}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(-1),children:(0,Z.jsx)("polygon",{points:w.Arrows[0]})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(-1,!1),children:(0,Z.jsx)("polygon",{points:w.Arrows[1]})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(1,!1),children:(0,Z.jsx)("polygon",{points:w.Arrows[2]})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(1),children:(0,Z.jsx)("polygon",{points:w.Arrows[3]})})]}),(0,Z.jsx)(b,{register:"coordinates"}),(0,Z.jsxs)("svg",{className:"direction",viewBox:"0 0 100 57",children:[(0,Z.jsx)("image",{xlinkHref:u.Z.map.dir,width:100,height:57}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(7,!1),children:(0,Z.jsx)("polygon",{points:"51,15 73,3 95,15 73,27"})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(7),children:(0,Z.jsx)("polygon",{points:"51,41 73,29 95,41 73,53"})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(-7,!1),children:(0,Z.jsx)("polygon",{points:"4,41 26,29 48,41 26,53"})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(-7),children:(0,Z.jsx)("polygon",{points:"4,15 26,3 48,15 26,27"})})]})]})}}]),e}(s.Z),b=function(n){(0,a.Z)(e,n);var t=(0,o.Z)(e);function e(){var n;(0,i.Z)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=t.call.apply(t,[this].concat(a))).x=C.x,n.y=C.y,n.inputX=d.createRef(),n.inputY=d.createRef(),n}return(0,r.Z)(e,[{key:"safe",value:function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return n<-50?-50:n>50?50:n}},{key:"updateMap",value:function(){var n=this.x,t=this.y;isNaN(n)||isNaN(t)||M(f.Z.getId(this.safe(n),this.safe(t)))}},{key:"updateInputs",value:function(){this.inputX.current.value=this.x=C.x,this.inputY.current.value=this.y=C.y}},{key:"number",value:function(n,t){var e=Number(n.target.value);return this.safe(isNaN(e)?t:e)}},{key:"render",value:function(){var n=this;return(0,Z.jsxs)("form",{onSubmit:function(t){t.preventDefault(),n.updateMap()},className:"CoordinatesForm",children:[(0,Z.jsx)("input",{type:"number",min:-50,max:50,defaultValue:C.x,ref:this.inputX,onBlur:function(t){return t.target.value=n.x},onChange:function(t){return n.x=n.number(t,C.x)}}),(0,Z.jsx)("input",{type:"number",min:-50,max:50,defaultValue:C.y,ref:this.inputY,onBlur:function(t){return t.target.value=n.y},onChange:function(t){return n.y=n.number(t,C.y)}}),(0,Z.jsx)(h.Z,{type:"submit",size:"sm",variant:"secondary",children:"\u0628\u062d\u062b"})]})}}]),e}(s.Z),q=function(n){(0,a.Z)(e,n);var t=(0,o.Z)(e);function e(){var n;(0,i.Z)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=t.call.apply(t,[this].concat(a))).view=!1,n.landType=0,n.taken=0,n.landName="",n.playerName="",n.race=1,n.population=0,n.allianceName="",n.isVillage=0,n.x=0,n.y=0,n.coordinates=d.createRef(),n}return(0,r.Z)(e,[{key:"getLandFeilds",value:function(){return this.landName+" "+(0,v.Z)(this.landType).join("-")}},{key:"updateCoordinates",value:function(){this.coordinates.current.textContent=this.view?this.x+" , "+this.y:C.x+" , "+C.y}},{key:"render",value:function(){return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("h4",{className:"title",children:["\u062e\u0631\u064a\u0637\u0629 (",(0,Z.jsxs)("span",{ref:this.coordinates,children:[C.x," , ",C.y]}),")"]}),(0,Z.jsx)("table",{style:{opacity:this.view&&this.taken?1:.5},className:"info_box table_collapsed",children:(0,Z.jsxs)("tbody",{children:[(0,Z.jsx)("tr",{children:(0,Z.jsx)("th",{colSpan:2,children:this.view?this.isVillage&&!this.taken?this.getLandFeilds():this.landName:"\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644"})}),(0,Z.jsxs)("tr",{children:[(0,Z.jsx)("td",{children:"\u0627\u0644\u0644\u0627\u0639\u0628:"}),(0,Z.jsx)("td",{children:this.view&&this.taken?this.playerName:"-"})]}),(0,Z.jsxs)("tr",{children:[(0,Z.jsx)("td",{children:"\u0627\u0644\u0633\u0643\u0627\u0646:"}),(0,Z.jsx)("td",{children:this.view&&this.taken&&this.isVillage?this.population:"-"})]}),(0,Z.jsxs)("tr",{children:[(0,Z.jsx)("td",{children:"\u0627\u0644\u062a\u062d\u0627\u0644\u0641:"}),(0,Z.jsx)("td",{children:this.view&&this.taken?this.allianceName:"-"})]})]})})]})}}]),e}(s.Z),A=function(n){(0,a.Z)(e,n);var t=(0,o.Z)(e);function e(){var n;(0,i.Z)(this,e);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=t.call.apply(t,[this].concat(a))).state={Content:[]},n.isRequesting=!1,n}return(0,r.Z)(e,[{key:"view",value:function(n,t){N("map-info",{playerName:n[0],landName:n[1],allianceName:n[2],race:t[1],isVillage:t[2],taken:t[3],population:t[4],x:t[5],y:t[6],landType:t[7],view:!0}),R("map-info","updateCoordinates")}},{key:"hide",value:function(){N("map-info",{view:!1}),R("map-info","updateCoordinates")}},{key:"request",value:function(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isRequesting||(this.isRequesting=!0,m(t).then((function(e){if(n.componentIsReady){n.isRequesting=!1,C.isRequesting=!1;var i=[],r=[],a=[],o=0,s=1;e.info.forEach((function(t,c){var h=e.data[c],d=w.Position[c],v=w.Polygon[c];i.push((0,Z.jsx)("image",{xlinkHref:u.Z.map[t[3]],x:d[0],y:d[1],width:"74",height:"74"},"Map-Image-".concat(c,"-").concat(h[0]))),r.push((0,Z.jsx)(l.rU,{onBlur:function(){return n.hide()},onMouseLeave:function(){return n.hide()},onFocus:function(){return n.view(t,h)},onMouseEnter:function(){return n.view(t,h)},to:"/View?id="+h[0],children:(0,Z.jsx)("polygon",{points:v,opacity:0})},"Map-Link-".concat(c,"-").concat(h[0])));var f=w.Ruler;if(c%7===0){var p=f[s];a.push((0,Z.jsx)("text",{x:p[0]+30,y:p[1]+14,children:h[5]},"Map-Ruler-Y-".concat(c,"-").concat(h[0]))),s+=2}if(c<7){var g=f[o];a.push((0,Z.jsx)("text",{x:g[0]+30,y:g[1]+12,children:h[6]},"Map-Ruler-X-".concat(c,"-").concat(h[0]))),o+=2}})),n.updateState({Content:i.concat(r,a)}),C.update(t),R("coordinates","updateInputs"),R("map-info","updateCoordinates")}})))}},{key:"onReady",value:function(){this.request(C.id)}},{key:"render",value:function(){return this.state.Content}}]),e}(s.Z),U=I}}]);
//# sourceMappingURL=965.37a36466.chunk.js.map