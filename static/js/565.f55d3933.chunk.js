"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[565],{6788:function(t,e){var n={validCoordinates:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t>=-50&&t<=50&&e>=-50&&e<=50},safeCoordinate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return Math.floor(t<-50?-50:t>50?50:t)},safeId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Math.floor(t<1?1:t>10201?10201:t)},getId:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.safeId(101*(t+50)+(e+50+1))},getCoordinates:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this.safeId(t)-1,n=Math.floor(e/101),i=Math.floor(e-101*n);return{x:n-50,y:i-50}}};e.Z=n},8959:function(t,e){var n=[4,5,5,4,3,3,4,3,1],i=[4,4,3,5,5,4,3,3,1],a=[4,3,4,3,4,5,5,3,1],r=[6,6,6,6,6,6,6,9,15];e.Z=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return[n[t],i[t],a[t],r[t]]}},6565:function(t,e,n){n.r(e),n.d(e,{default:function(){return V}});var i=n(5671),a=n(3144),r=n(136),o=n(8557),s=n(2888),u=n(4095),l=n(9466),c=n(7683),h=n(3298),d=n(7313),f=n(8959),v=n(6788),p=n(3323),x=n(547),g=n(2974),y=n.n(g),j=(0,a.Z)((function t(e){(0,i.Z)(this,t),this.info=e.info,this.data=e.data}));function m(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return x.Z.request(y().MAP_VIEW_NORMAL,{id:Math.floor(t>=1&&t<=10201?t:0)})}x.Z.defineStructure(y().MAP_VIEW_NORMAL,j);var k=n(5033),Z=n(6417),w={Position:[[16,104],[52,84],[88,64],[124,44],[160,24],[196,4],[232,-16],[53,124],[89,104],[125,84],[161,64],[197,44],[233,24],[269,4],[90,144],[126,124],[162,104],[198,84],[234,64],[270,44],[306,24],[127,164],[163,144],[199,124],[235,104],[271,84],[307,64],[343,44],[164,184],[200,164],[236,144],[272,124],[308,104],[344,84],[380,64],[201,204],[237,184],[273,164],[309,144],[345,124],[381,104],[417,84],[238,224],[274,204],[310,184],[346,164],[382,144],[418,124],[454,104]],Ruler:[[280,292],[280,8],[316,272],[316,28],[352,252],[352,48],[388,232],[388,68],[424,212],[424,88],[460,192],[460,108],[496,172],[496,128]],Arrows:["144,56 98,84 98,49","102,233 149,260 101,266","439,87 390,57 438,52","443,266 394,257 442,232"],Polygon:["53,137 90,157 53,177 16,157","89,117 126,137 89,157 52,137","125,97 162,117 125,137 88,117","161,77 198,97 161,117 124,97","197,57 234,77 197,97 160,77","233,37 270,57 233,77 196,57","269,17 306,37 269,57 232,37","90,157 127,177 90,197 53,177","126,137 163,157 126,177 89,157","162,117 199,137 162,157 125,137","198,97 235,117 198,137 161,117","234,77 271,97 234,117 197,97","270,57 307,77 270,97 233,77","306,37 343,57 306,77 269,57","127,177 164,197 127,217 90,197","163,157 200,177 163,197 126,177","199,137 236,157 199,177 162,157","235,117 272,137 235,157 198,137","271,97 308,117 271,137 234,117","307,77 344,97 307,117 270,97","343,57 380,77 343,97 306,77","164,197 201,217 164,237 127,217","200,177 237,197 200,217 163,197","236,157 273,177 236,197 199,177","272,137 309,157 272,177 235,157","308,117 345,137 308,157 271,137","344,97 381,117 344,137 307,117","380,77 417,97 380,117 343,97","201,217 238,237 201,257 164,237","237,197 274,217 237,237 200,217","273,177 310,197 273,217 236,197","309,157 346,177 309,197 272,177","345,137 382,157 345,177 308,157","381,117 418,137 381,157 344,137","417,97 454,117 417,137 380,117","238,237 275,257 238,277 201,257","274,217 311,237 274,257 237,237","310,197 347,217 310,237 273,217","346,177 383,197 346,217 309,197","382,157 419,177 382,197 345,177","418,137 455,157 418,177 381,157","454,117 491,137 454,157 417,137","275,257 312,277 275,297 238,277","311,237 348,257 311,277 274,257","347,217 384,237 347,257 310,237","383,197 420,217 383,237 346,217","419,177 456,197 419,217 382,197","455,157 492,177 455,197 418,177","491,137 528,157 491,177 454,157"]},C={id:0,x:0,y:0,isRequesting:!1,update:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=v.Z.safeId(t),n=v.Z.getCoordinates(e);return this.id=e,this.x=n.x,this.y=n.y,e}},N=function(t,e){return c.Z.safe(t,(function(t){return t.updateProps(e)}))},R=function(t,e,n){return c.Z.safe(t,(function(t){return t[e](n)}))},M=function(t){return R("map-view","request",C.update(t))},b=function(t){(0,r.Z)(n,t);var e=(0,o.Z)(n);function n(){return(0,i.Z)(this,n),e.apply(this,arguments)}return(0,a.Z)(n,[{key:"coordinate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t<-50?t+101:t>50?t-101:t}},{key:"navigate",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function(i){i.preventDefault(),C.isRequesting||(C.isRequesting=!0,M(n?v.Z.getId(t.coordinate(C.x+e),C.y):v.Z.getId(C.x,t.coordinate(C.y+e))))}}},{key:"onRemoved",value:function(){C.id=0}},{key:"render",value:function(){return C.id=C.update((0,p.Z)("id",k.Z.activeVillageId,!0)),R("coordinates","updateInputs"),(0,Z.jsxs)("div",{id:"Map",children:[(0,Z.jsx)(q,{register:"map-info"}),(0,Z.jsxs)("svg",{className:"background",viewBox:"0 0 540 316",children:[(0,Z.jsx)("image",{xlinkHref:u.Z.map.background,width:540,height:316}),(0,Z.jsx)(A,{register:"map-view"}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(-1),children:(0,Z.jsx)("polygon",{points:w.Arrows[0]})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(-1,!1),children:(0,Z.jsx)("polygon",{points:w.Arrows[1]})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(1,!1),children:(0,Z.jsx)("polygon",{points:w.Arrows[2]})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(1),children:(0,Z.jsx)("polygon",{points:w.Arrows[3]})})]}),(0,Z.jsx)(I,{register:"coordinates"}),(0,Z.jsxs)("svg",{className:"direction",viewBox:"0 0 100 57",children:[(0,Z.jsx)("image",{xlinkHref:u.Z.map.dir,width:100,height:57}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(7,!1),children:(0,Z.jsx)("polygon",{points:"51,15 73,3 95,15 73,27"})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(7),children:(0,Z.jsx)("polygon",{points:"51,41 73,29 95,41 73,53"})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(-7,!1),children:(0,Z.jsx)("polygon",{points:"4,41 26,29 48,41 26,53"})}),(0,Z.jsx)(l.rU,{to:"#",onClick:this.navigate(-7),children:(0,Z.jsx)("polygon",{points:"4,15 26,3 48,15 26,27"})})]})]})}}]),n}(s.Z),I=function(t){(0,r.Z)(n,t);var e=(0,o.Z)(n);function n(){var t;(0,i.Z)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))).x=C.x,t.y=C.y,t.inputX=d.createRef(),t.inputY=d.createRef(),t}return(0,a.Z)(n,[{key:"safe",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t<-50?-50:t>50?50:t}},{key:"updateMap",value:function(){var t=this.x,e=this.y;isNaN(t)||isNaN(e)||M(v.Z.getId(this.safe(t),this.safe(e)))}},{key:"updateInputs",value:function(){this.inputX.current.value=this.x=C.x,this.inputY.current.value=this.y=C.y}},{key:"number",value:function(t,e){var n=Number(t.target.value);return this.safe(isNaN(n)?e:n)}},{key:"render",value:function(){var t=this;return(0,Z.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t.updateMap()},className:"CoordinatesForm",children:[(0,Z.jsx)("input",{type:"number",min:-50,max:50,defaultValue:C.x,ref:this.inputX,onBlur:function(e){return e.target.value=t.x},onChange:function(e){return t.x=t.number(e,C.x)}}),(0,Z.jsx)("input",{type:"number",min:-50,max:50,defaultValue:C.y,ref:this.inputY,onBlur:function(e){return e.target.value=t.y},onChange:function(e){return t.y=t.number(e,C.y)}}),(0,Z.jsx)(h.Z,{type:"submit",size:"sm",variant:"secondary",children:"\u0628\u062d\u062b"})]})}}]),n}(s.Z),q=function(t){(0,r.Z)(n,t);var e=(0,o.Z)(n);function n(){var t;(0,i.Z)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))).view=!1,t.landType=0,t.taken=0,t.landName="",t.playerName="",t.race=1,t.population=0,t.allianceName="",t.isVillage=0,t.x=0,t.y=0,t.coordinates=d.createRef(),t}return(0,a.Z)(n,[{key:"getLandFeilds",value:function(){return this.landName+" "+(0,f.Z)(this.landType).join("-")}},{key:"updateCoordinates",value:function(){this.coordinates.current.textContent=this.view?this.x+" , "+this.y:C.x+" , "+C.y}},{key:"render",value:function(){return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)("h4",{className:"title",children:["\u062e\u0631\u064a\u0637\u0629 (",(0,Z.jsxs)("span",{ref:this.coordinates,children:[C.x," , ",C.y]}),")"]}),(0,Z.jsx)("table",{style:{opacity:this.view&&this.taken?1:.5},className:"info_box table_collapsed",children:(0,Z.jsxs)("tbody",{children:[(0,Z.jsx)("tr",{children:(0,Z.jsx)("th",{colSpan:2,children:this.view?this.isVillage&&!this.taken?this.getLandFeilds():this.landName:"\u0627\u0644\u062a\u0641\u0627\u0635\u064a\u0644"})}),(0,Z.jsxs)("tr",{children:[(0,Z.jsx)("td",{children:"\u0627\u0644\u0644\u0627\u0639\u0628:"}),(0,Z.jsx)("td",{children:this.view&&this.taken?this.playerName:"-"})]}),(0,Z.jsxs)("tr",{children:[(0,Z.jsx)("td",{children:"\u0627\u0644\u0633\u0643\u0627\u0646:"}),(0,Z.jsx)("td",{children:this.view&&this.taken&&this.isVillage?this.population:"-"})]}),(0,Z.jsxs)("tr",{children:[(0,Z.jsx)("td",{children:"\u0627\u0644\u062a\u062d\u0627\u0644\u0641:"}),(0,Z.jsx)("td",{children:this.view&&this.taken?this.allianceName:"-"})]})]})})]})}}]),n}(s.Z),A=function(t){(0,r.Z)(n,t);var e=(0,o.Z)(n);function n(){var t;(0,i.Z)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))).state={Content:[]},t.isRequesting=!1,t}return(0,a.Z)(n,[{key:"view",value:function(t,e){N("map-info",{playerName:t[0],landName:t[1],allianceName:t[2],race:e[1],isVillage:e[2],taken:e[3],population:e[4],x:e[5],y:e[6],landType:e[7],view:!0}),R("map-info","updateCoordinates")}},{key:"hide",value:function(){N("map-info",{view:!1}),R("map-info","updateCoordinates")}},{key:"request",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.isRequesting||(this.isRequesting=!0,m(e).then((function(n){if(t.componentIsReady){t.isRequesting=!1,C.isRequesting=!1;var i=[],a=[],r=[],o=0,s=1;n.info.forEach((function(e,c){var h=n.data[c],d=w.Position[c],f=w.Polygon[c];i.push((0,Z.jsx)("image",{xlinkHref:u.Z.map[e[3]],x:d[0],y:d[1],width:"74",height:"74"},"Map-Image-".concat(c,"-").concat(h[0]))),a.push((0,Z.jsx)(l.rU,{onBlur:function(){return t.hide()},onMouseLeave:function(){return t.hide()},onFocus:function(){return t.view(e,h)},onMouseEnter:function(){return t.view(e,h)},to:"/View?id="+h[0],children:(0,Z.jsx)("polygon",{points:f,opacity:0})},"Map-Link-".concat(c,"-").concat(h[0])));var v=w.Ruler;if(c%7===0){var p=v[s];r.push((0,Z.jsx)("text",{x:p[0]+30,y:p[1]+14,children:h[5]},"Map-Ruler-Y-".concat(c,"-").concat(h[0]))),s+=2}if(c<7){var x=v[o];r.push((0,Z.jsx)("text",{x:x[0]+30,y:x[1]+12,children:h[6]},"Map-Ruler-X-".concat(c,"-").concat(h[0]))),o+=2}})),t.updateState({Content:i.concat(a,r)}),C.update(e),R("coordinates","updateInputs"),R("map-info","updateCoordinates")}})))}},{key:"onReady",value:function(){this.request(C.id)}},{key:"render",value:function(){return this.state.Content}}]),n}(s.Z),V=b}}]);