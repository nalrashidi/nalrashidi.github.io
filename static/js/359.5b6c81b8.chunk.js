"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[359],{9359:function(e,r,t){t.r(r),t.d(r,{default:function(){return w}});var n=t(5671),s=t(3144),i=t(136),a=t(8557),l=t(7313),o=t(3871),d=t(5668),c=t(3849),h=t(2102),u=t(1616),f=t(9466),x=t(2888),j=t(2291),v=t(5626),m=t(4275),p=t(3983),Z=t(3514),g=t(6417),y=function(e){(0,i.Z)(t,e);var r=(0,a.Z)(t);function t(e){var s;return(0,n.Z)(this,t),(s=r.call(this,e)).timer=0,s.ref=l.createRef(),s.order=e.order,s.onFinish=e.onFinish,s}return(0,s.Z)(t,[{key:"componentDidMount",value:function(){var e=this;this.timer=setInterval((function(){var r=Math.floor((e.order.finishAt-Date.now())/1e3);if(r<0)return clearInterval(e.timer),void e.onFinish();e.ref.current.textContent=Z.Z.toTime(r)}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){return(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:"X"}),(0,g.jsxs)("td",{children:[j.Z.Name(this.order.buildingId)," (\u0627\u0644\u0645\u0633\u062a\u0648\u0649 ",this.order.level,")"]}),(0,g.jsxs)("td",{children:["\u0628\u0627\u0642\u064a ",(0,g.jsx)("span",{ref:this.ref,children:Z.Z.toTime(Math.floor((this.order.finishAt-Date.now())/1e3))})," \u0645\u0646 \u0627\u0644\u0648\u0642\u062a "]})]})}}]),t}(l.PureComponent),k=function(e){(0,i.Z)(t,e);var r=(0,a.Z)(t);function t(e){var s;return(0,n.Z)(this,t),(s=r.call(this,e)).state={refresh:0},s.orders=e.orders,s}return(0,s.Z)(t,[{key:"ordersRow",value:function(){var e=this;return this.orders.filter((function(e){return e.finishAt-Date.now()>0})).map((function(r){return(0,g.jsx)(y,{order:r,onFinish:function(){return e.refresh()}},r.finishAt)}))}},{key:"refresh",value:function(){this.setState({refresh:Date.now()})}},{key:"render",value:function(){var e=this.ordersRow();return 0===e.length?(0,g.jsx)(g.Fragment,{}):(0,g.jsxs)("table",{id:"upgrades",children:[(0,g.jsx)("thead",{children:(0,g.jsx)("tr",{children:(0,g.jsxs)("th",{colspan:"3",children:["\u0627\u0644\u0628\u0646\u0627\u0621: ",p.M.clock()]})})}),(0,g.jsx)("tbody",{children:e})]},this.state.refresh)}}]),t}(l.PureComponent),F=function(e){(0,i.Z)(t,e);var r=(0,a.Z)(t);function t(){var e;(0,n.Z)(this,t);for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return(e=r.call.apply(r,[this].concat(i))).state={ready:!1,name:"",isCapital:!1,feilds:(0,g.jsx)(g.Fragment,{}),movements:(0,g.jsx)(g.Fragment,{}),productions:[0,0,0,0],orders:null,troops:(0,g.jsx)(g.Fragment,{})},e}return(0,s.Z)(t,[{key:"onReady",value:function(){var e=this;(0,m.Z)().then((function(r){if(e.componentIsReady&&r){var t=[],n=r.id,s=r.buildings;t.push((0,g.jsx)("image",{xlinkHref:v.Z.village[r.type]},"FeildsBackground"));for(var i=1;i<=18;i++)t.push(j.Z.FromResponse(s[i-1],n).LinkComponent);t.push((0,g.jsx)(f.rU,{to:"/Center",children:(0,g.jsx)(o.Z,{placement:"top",overlay:(0,g.jsx)(d.Z,{id:"center-tooltip",children:"\u0645\u0631\u0643\u0632 \u0627\u0644\u0642\u0631\u064a\u0629"}),children:(0,g.jsx)("path",{opacity:0,d:"M122 108 148 105 169 108 182 120 184 133 181 143 170 152 160 155 141 157 130 157 114 153 106 145 102 134 104 124 110 115Z"})})},"Center-Building")),e.updateState({ready:!0,name:r.name,isCapital:r.isCapital,feilds:t,productions:r.productions,orders:r.orders})}}))}},{key:"villageOrders",value:function(){return 0===this.state.orders.length?(0,g.jsx)(g.Fragment,{}):(0,g.jsx)(c.Z,{children:(0,g.jsx)(k,{orders:this.state.orders})})}},{key:"render",value:function(){return this.state.ready?(0,g.jsxs)("div",{className:"VillageView",children:[(0,g.jsxs)("h4",{className:"VillageName title",children:[this.state.name,this.state.isCapital?(0,g.jsx)("span",{className:"capital",children:"(\u0627\u0644\u0639\u0627\u0635\u0645\u0629)"}):(0,g.jsx)(g.Fragment,{})]}),(0,g.jsxs)(h.Z,{children:[(0,g.jsxs)(c.Z,{children:[(0,g.jsx)(u.Z,{children:(0,g.jsx)("div",{children:(0,g.jsx)("svg",{viewBox:"0 0 300 264",className:"feilds",children:this.state.feilds})})}),(0,g.jsxs)(u.Z,{children:[(0,g.jsx)("div",{className:"movements"}),(0,g.jsx)(C,{data:this.state.productions}),(0,g.jsx)("div",{className:"troops"})]})]}),this.villageOrders()]})]}):(0,g.jsx)(g.Fragment,{})}}]),t}(x.Z);function C(e){var r=e.data;return(0,g.jsxs)("table",{className:"productions",children:[(0,g.jsx)("thead",{children:(0,g.jsx)("tr",{children:(0,g.jsx)("th",{colSpan:3,children:"\u0627\u0644\u0625\u0646\u062a\u0627\u062c \u0643\u0644 \u0633\u0627\u0639\u0629:"})})}),(0,g.jsx)("tbody",{children:r.map((function(e,r){return(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{children:p.M.res("r"+(r+1))}),(0,g.jsx)("td",{children:(0,g.jsx)("b",{children:e.toLocaleString()})}),(0,g.jsx)("td",{children:p.M.title("r"+(r+1))})]},r)}))})]})}var w=F}}]);